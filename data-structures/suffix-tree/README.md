# Suffix Tree
A suffix tree is a rooted and directed tree. It has n leaf nodes labeled from _1_ to _n_, and its edges are labeled by letters. A path from root to leaf node _l_, we can read the string's suffix ```S[l, n]``` and a ```$``` sign.
The path is denoted as ```P(j)```.

A suffix ```S[i, j]``` denotes the substring of a string _S_ from índex _i_ to _j_. We concat a new string ```$``` to S, to avoid cases when  a suffix is a prefix of another suffix. 

## Suffix Tree Example
  The following image is the suffix tre for the word ```aabccb```

[![](https://mermaid.ink/img/pako:eNp9VsGO2zYQ_RVWSQC7tde1tXGyTqOi2e2hQJoUm1yKdQ4jkrKIyKSWpLIxFj7nK_oPQa4B-g3OrZ_TESVZEmVEB5ki37x5bziSeR9QxXiwCjYa8pS8fbGWBC-tlH2FC6MRIeMxmU4JxVtEaD05HvdxJSJ2iPg7CHAI8BDVnfZpqM9TTZSAhzXgYYV4fEQ0gFqqr5X6KYY5BkmOWc5LTIXyMA1i2bDEno54PrAy70PigdbYFxsP1cYDuXGrN8RdawRDnwp8IvAUQ0wHCDqAnMBQP9FQNAxVQ0f2oi0zeF3jtw34toa-BsZOOBtaO-XthLmT7k7Z6_qbt_4ePTp2SkR4zcQbpt6qqBbFycWiWiz6rxNCeIupawcdgs5q1mTPBhzQAUFyXT7d6HceKOtxQfISb27mJvOhoge8ciDmg4oe6G8H2vkg09bODGvXrtp61Q7rYzp5TKcCHWPGN2aOvo4o24JUk011tCjbZ_lLlhR5l8Lc3ry5LUBzYlLI-bvqwyFGo0uhaVbP9qSZIq6-2L8dp8pLseg1YzULtuDbO0UyIfkvsZ5FnG04oWq75dK6DFr1gpm4vxKwVZKRO2FT4oJcOIk1h_d7Mj1zUaNrVUjGGQIi43S7kRPpMT5_Hmm1aAKI6bjs9KJkHWuvlBWUE5uCJVIRyz9aImQVQ8poYCVVynEopLEcWAUWhkCec5coKbRFBGHqrmWuN4mF0TWHLNuRTMlNlcAZLq06p6UdTAmStNXsKLysaojpEutyFDFuUs41LStrxEaaNudo9IeUiJrhhpabWXIDltioLUctjLja5ZwKyAhNQQNFUuP-dSOSjCZnv_7w0_TH_750tp_u9M3lTossExS3OcLnRb9ZyOGfw-dvnw6fD18P_47Hz5pYQjMw5oonZKM5lyRBjtWDi2Q5MVar93z1IAzDejy9E8ymq0X-8ZkfrDRIbKYqOrn4TvS5F40tMKk_h5Pmuzhpfo4T0Bl2xrxS3eNjolazlsEk2HK9BcHwQHNfotYBdsGWr4MVDhlPoMjsOljLPUKLnIHlvzNhlQ5WCWSGTwIorHqzkzRYWV3wBoSvBb5t2yMqU8A4Bt0Hdpe705MwFimpkonYlPOFznA6tTY3q9msXD7bYIsV8Rm-gDMjGG60TT9cLGfLxfIpLEK-fBLC4zBkeDq4eJoszucJe_LzfAHBfj8JuFP5Z3VUcye2_f9I9dz7?type=png)](https://mermaid.live/edit#pako:eNp9VsGO2zYQ_RVWSQC7tde1tXGyTqOi2e2hQJoUm1yKdQ4jkrKIyKSWpLIxFj7nK_oPQa4B-g3OrZ_TESVZEmVEB5ki37x5bziSeR9QxXiwCjYa8pS8fbGWBC-tlH2FC6MRIeMxmU4JxVtEaD05HvdxJSJ2iPg7CHAI8BDVnfZpqM9TTZSAhzXgYYV4fEQ0gFqqr5X6KYY5BkmOWc5LTIXyMA1i2bDEno54PrAy70PigdbYFxsP1cYDuXGrN8RdawRDnwp8IvAUQ0wHCDqAnMBQP9FQNAxVQ0f2oi0zeF3jtw34toa-BsZOOBtaO-XthLmT7k7Z6_qbt_4ePTp2SkR4zcQbpt6qqBbFycWiWiz6rxNCeIupawcdgs5q1mTPBhzQAUFyXT7d6HceKOtxQfISb27mJvOhoge8ciDmg4oe6G8H2vkg09bODGvXrtp61Q7rYzp5TKcCHWPGN2aOvo4o24JUk011tCjbZ_lLlhR5l8Lc3ry5LUBzYlLI-bvqwyFGo0uhaVbP9qSZIq6-2L8dp8pLseg1YzULtuDbO0UyIfkvsZ5FnG04oWq75dK6DFr1gpm4vxKwVZKRO2FT4oJcOIk1h_d7Mj1zUaNrVUjGGQIi43S7kRPpMT5_Hmm1aAKI6bjs9KJkHWuvlBWUE5uCJVIRyz9aImQVQ8poYCVVynEopLEcWAUWhkCec5coKbRFBGHqrmWuN4mF0TWHLNuRTMlNlcAZLq06p6UdTAmStNXsKLysaojpEutyFDFuUs41LStrxEaaNudo9IeUiJrhhpabWXIDltioLUctjLja5ZwKyAhNQQNFUuP-dSOSjCZnv_7w0_TH_750tp_u9M3lTossExS3OcLnRb9ZyOGfw-dvnw6fD18P_47Hz5pYQjMw5oonZKM5lyRBjtWDi2Q5MVar93z1IAzDejy9E8ymq0X-8ZkfrDRIbKYqOrn4TvS5F40tMKk_h5Pmuzhpfo4T0Bl2xrxS3eNjolazlsEk2HK9BcHwQHNfotYBdsGWr4MVDhlPoMjsOljLPUKLnIHlvzNhlQ5WCWSGTwIorHqzkzRYWV3wBoSvBb5t2yMqU8A4Bt0Hdpe705MwFimpkonYlPOFznA6tTY3q9msXD7bYIsV8Rm-gDMjGG60TT9cLGfLxfIpLEK-fBLC4zBkeDq4eJoszucJe_LzfAHBfj8JuFP5Z3VUcye2_f9I9dz7)

### Space Compressed Suffix Tree
As we can see suffix trees uses much space. The image above has long branches with only one node/element. We can do better, compacting the suffix tree. A compact suffix tree is a root directed tree with n leafs. Each internal node has at least two children. The label of a path é the concat of the labels over its edges. 
The following imagem is the compacted suffix tree from word ```aabccb```

[![](https://mermaid.ink/img/pako:eNp9lc2O2zYQx1-FVRLATu111to4WSdRkOz2UKBJi00uxTqHETmyiNCkQlLdGAuf-xR9hyDXAH0G99bHKUV9UdoiPsgU5zf_-SAp3kZUMYzW0VZDkZP3rzeSuJ9Wyr51hsmEkOmUzOeEukdCaDM5nQ65ikg9kX6HAE_AiKiftJO5X0dK79fc45brCNoiHXNWMTWVdlSLpT0Xt1od1SCNfeXtrRR0KXVaEIgtW7GOgwAMydM-vQcPutgJwaZZ2CoNrLw28v81lrWxHDbRIdgzTaMhEAisoo0u7mhAAEF2Vb1d6w8jSAy0IPvFPfzMtRijfABeeoiNoXIA_e6h_Rgyfe_M3d71VttY7d3-mCCOCToQFGbGhZmuro6yPaTaaCrIRdmhym-ykihCCfPp-t2nEjQSk0OBH-pNzSeTC66paGYHqZkyrc_pq26q-imW_MpYo-L24fsbRQSX-DzViwTZFglVux1K6yNoNXBm_PaSw05JRm64zYl38u4k1QgfD2R-4r0mV6qUDJkDEuPz9iOf5EjxxYtEq2XrQExQZbAXJQtKe6ssp0hsDpZIRSx-toTL2odU3sAqqRzdkEtjEVgNc0OgKNAHykptHUGYuumVm0VicXKFIMSeCCW3dQBfcFWqr7Qqx4UESfpuBhle1D104TLrY5SpW6QCNa06a_hWmj7mZPKzlI5auAWtFrPSBtdio3bocmHE965AykEQmoMG6kSN_9YmJJvMTl7-8OP84b9fg-Wne319sddcCE7dMifufTncLOT41_HLP38evxy_Hf-eTp-1voQKMOYSM7LViJJkTmN97zxbzYzV6iOu78Vx3IznN5zZfL0sPj8bOysN0m2m2js7_4732cjbbYFZ8zmctd_FWfvXTUAwDMZYZz3QY7zJZiOjWbRDvQPO3DV2W1GbyO2CHW6itRsyzKAUdhNt5MGhZcHA4k-MW6WjdQbC4CyC0qp3e0mjtdUltpA7Fu607TpKKGDonG4juy_8ncmNdZJUyYxvq_lSCzedW1uY9WJRmU-2bouV6Yk7gAvDmVtom_9xvlqslqunsIxx9SSGx3HMaHp6_jRbnp1m7Mmj0yVEh8MsQp_lm_qC9vf04T9D5VQv?type=png)](https://mermaid.live/edit#pako:eNp9lc2O2zYQx1-FVRLATu111to4WSdRkOz2UKBJi00uxTqHETmyiNCkQlLdGAuf-xR9hyDXAH0G99bHKUV9UdoiPsgU5zf_-SAp3kZUMYzW0VZDkZP3rzeSuJ9Wyr51hsmEkOmUzOeEukdCaDM5nQ65ikg9kX6HAE_AiKiftJO5X0dK79fc45brCNoiHXNWMTWVdlSLpT0Xt1od1SCNfeXtrRR0KXVaEIgtW7GOgwAMydM-vQcPutgJwaZZ2CoNrLw28v81lrWxHDbRIdgzTaMhEAisoo0u7mhAAEF2Vb1d6w8jSAy0IPvFPfzMtRijfABeeoiNoXIA_e6h_Rgyfe_M3d71VttY7d3-mCCOCToQFGbGhZmuro6yPaTaaCrIRdmhym-ykihCCfPp-t2nEjQSk0OBH-pNzSeTC66paGYHqZkyrc_pq26q-imW_MpYo-L24fsbRQSX-DzViwTZFglVux1K6yNoNXBm_PaSw05JRm64zYl38u4k1QgfD2R-4r0mV6qUDJkDEuPz9iOf5EjxxYtEq2XrQExQZbAXJQtKe6ssp0hsDpZIRSx-toTL2odU3sAqqRzdkEtjEVgNc0OgKNAHykptHUGYuumVm0VicXKFIMSeCCW3dQBfcFWqr7Qqx4UESfpuBhle1D104TLrY5SpW6QCNa06a_hWmj7mZPKzlI5auAWtFrPSBtdio3bocmHE965AykEQmoMG6kSN_9YmJJvMTl7-8OP84b9fg-Wne319sddcCE7dMifufTncLOT41_HLP38evxy_Hf-eTp-1voQKMOYSM7LViJJkTmN97zxbzYzV6iOu78Vx3IznN5zZfL0sPj8bOysN0m2m2js7_4732cjbbYFZ8zmctd_FWfvXTUAwDMZYZz3QY7zJZiOjWbRDvQPO3DV2W1GbyO2CHW6itRsyzKAUdhNt5MGhZcHA4k-MW6WjdQbC4CyC0qp3e0mjtdUltpA7Fu607TpKKGDonG4juy_8ncmNdZJUyYxvq_lSCzedW1uY9WJRmU-2bouV6Yk7gAvDmVtom_9xvlqslqunsIxx9SSGx3HMaHp6_jRbnp1m7Mmj0yVEh8MsQp_lm_qC9vf04T9D5VQv)


## Time Complexity
